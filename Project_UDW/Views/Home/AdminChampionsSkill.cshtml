@{
    ViewData["Title"] = "Champion Skill";
    Layout = "~/Views/Shared/Master.cshtml";
}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>@ViewData["Title"]</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/css/AdminChampionSkill.css">
<!-- jQuery should be loaded here -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div id="addskillModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Champions Skills Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addskillForm">
                    <div class="mb-3">
                        <label for="champnameskill" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="champnameskill" name="champnameskill" required>
                    </div>
                    <div class="mb-3">
                        <label for="skillnt" class="form-label">Skill Noi Tai</label>
                        <input type="text" class="form-control" id="skillnt" name="skillnt" required>
                    </div>
                    <div class="mb-3">
                        <label for="skillq" class="form-label">Skill Q</label>
                        <input type="text" class="form-control" id="skillq" name="skillq" required>
                    </div>
                    <div class="mb-3">
                        <label for="skillw" class="form-label">Skill W</label>
                        <input type="text" class="form-control" id="skillw" name="skillw" required>
                    </div>
                    <div class="mb-3">
                        <label for="skille" class="form-label">Skill E</label>
                        <input type="text" class="form-control" id="skille" name="skille" required>
                    </div>
                    <div class="mb-3">
                        <label for="skillr" class="form-label">Skill R</label>
                        <input type="text" class="form-control" id="skillr" name="skillr" required>
                    </div>
                    <div class="mb-3">
                        <label for="avant" class="form-label">Image Noi Tai</label>
                        <input type='file' class="form-control" id="avant" name="avant" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="avaq" class="form-label">Image Q</label>
                        <input type='file' class="form-control" id="avaq" name="avaq" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="avavw" class="form-label">Image W</label>
                        <input type='file' class="form-control" id="avaw" name="avaw" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="avae" class="form-label">Image E</label>
                        <input type='file' class="form-control" id="avae" name="avae" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="avar" class="form-label">Image R</label>
                        <input type='file' class="form-control" id="avar" name="avar" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>

                    <div class="mb-3">
                        <label for="vdnt" class="form-label">Video noi tai</label>
                        <input type='file' class="form-control" id="vdnt" name="vdnt" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="vdq" class="form-label">Video Q</label>
                        <input type='file' class="form-control" id="vdq" name="vdq" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="vdw" class="form-label">Video W</label>
                        <input type='file' class="form-control" id="vdw" name="vdw" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="vde" class="form-label">Video E</label>
                        <input type='file' class="form-control" id="vde" name="vde" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="vdr" class="form-label">Video R</label>
                        <input type='file' class="form-control" id="vdr" name="vdr" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <button type="button" class="btn btn-primary" onclick="Submit_Skill()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="deleteskillModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Champions Skill Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="deleteskillForm">
                    <div class="mb-3">
                        <label for="delskillname" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="delskillname" name="delskillname" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="SubmitDeleteSkill()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="updateskillModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Champions Skills Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="updateskillsForm">
                    <div class="mb-3">
                        <label for="upchampnameskill" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="upchampnameskill" name="upchampnameskill" required>
                    </div>
                    <div class="mb-3">
                        <label for="upskillnt" class="form-label">Skill Noi Tai</label>
                        <input type="text" class="form-control" id="upskillnt" name="upskillnt" required>
                    </div>
                    <div class="mb-3">
                        <label for="upskillq" class="form-label">Skill Q</label>
                        <input type="text" class="form-control" id="upskillq" name="upskillq" required>
                    </div>
                    <div class="mb-3">
                        <label for="upskillw" class="form-label">Skill W</label>
                        <input type="text" class="form-control" id="upskillw" name="upskillw" required>
                    </div>
                    <div class="mb-3">
                        <label for="upskille" class="form-label">Skill E</label>
                        <input type="text" class="form-control" id="upskille" name="upskille" required>
                    </div>
                    <div class="mb-3">
                        <label for="upskillr" class="form-label">Skill R</label>
                        <input type="text" class="form-control" id="upskillr" name="upskillr" required>
                    </div>
                    <div class="mb-3">
                        <label for="upavant" class="form-label">Image Noi Tai</label>
                        <input type='file' class="form-control" id="upavant" name="upavant" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upavaq" class="form-label">Image Q</label>
                        <input type='file' class="form-control" id="upavaq" name="upavaq" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upavavw" class="form-label">Image W</label>
                        <input type='file' class="form-control" id="upavaw" name="upavaw" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upavae" class="form-label">Image E</label>
                        <input type='file' class="form-control" id="upavae" name="upavae" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upavar" class="form-label">Image R</label>
                        <input type='file' class="form-control" id="upavar" name="upavar" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>

                    <div class="mb-3">
                        <label for="upvdnt" class="form-label">Video noi tai</label>
                        <input type='file' class="form-control" id="upvdnt" name="upvdnt" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upvdq" class="form-label">Video Q</label>
                        <input type='file' class="form-control" id="upvdq" name="upvdq" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upvdw" class="form-label">Video W</label>
                        <input type='file' class="form-control" id="upvdw" name="upvdw" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upvde" class="form-label">Video E</label>
                        <input type='file' class="form-control" id="upvde" name="upvde" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upvdr" class="form-label">Video R</label>
                        <input type='file' class="form-control" id="upvdr" name="upvdr" required onchange="readURL(this);" />
                        <video id="blah" src="#" alt="" />
                    </div>
                    <button type="button" class="btn btn-primary" onclick="Submit_Update_Skill()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row add_championskill_main">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-9"></div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Add_Skill()">
                            <a style="float: right; cursor: pointer">Add skills</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Delete_Skill()">
                            <a style="float: right; cursor: pointer">Delete skills</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Update_Skill()">
                            <a style="float: right; cursor: pointer">Update skills</a>
                        </div>
                    </div>
                    <h4 class="card-title">Champions Skills</h4>
                    <h6 class="card-title mt-5"><i class="me-1 font-18 mdi mdi-numeric-1-box-multiple-outline"></i>Details</h6>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">STT</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Noi tai</th>
                                    <th scope="col">Q</th>
                                    <th scope="col">W</th>
                                    <th scope="col">E</th>
                                    <th scope="col">R</th>
                                    <th scope="col">AVA Skills</th>
                                    <th scope="col">Video Skills</th>
                                </tr>
                            </thead>
                            <tbody id="skillsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function Delete_Skill() {
        var modal = new bootstrap.Modal(document.getElementById('deleteskillModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Update_Skill() {
        var modal = new bootstrap.Modal(document.getElementById('updateskillModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Add_Skill() {
        var modal = new bootstrap.Modal(document.getElementById('addskillModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Submit_Update_Skill() {
        var formData = {
            ChampName: $('#upchampnameskill').val(),
            NoiTai: $('#upskillnt').val(),
            SkillQ: $('#upskillq').val(),
            SkillW: $('#upskillw').val(),
            SkillE: $('#upskille').val(),
            SkillR: $('#upskillr').val(),
            AVA_NT: $('#upavant').val(),
            AVA_Q: $('#upavaq').val(),
            AVA_W: $('#upavaw').val(),
            AVA_E: $('#upavae').val(),
            AVA_R: $('#upavar').val(),
            Vdnt: $('#upvdnt').val(),
            Vdq: $('#upvdq').val(),
            Vdw: $('#upvdw').val(),
            Vde: $('#upvde').val(),
            Vdr: $('#upvdr').val()
        };
        $.ajax({
            type: "POST",
            url: "/api/AdminSkill/UpdateSkill",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert('Champion skill updated successfully!');
                    $('#updateskillModal').modal('hide');
                    $('#updateskillForm')[0].reset();
                    location.reload();
                } else {
                    alert('Update failed: ' + response.statusMessage);
                }
            },
            error: function (error) {
                console.error('AJAX error:', error);
                alert('Error updating champion skill');
            }
        });
    }
    function SubmitDeleteSkill() {
        var formData = {
            ChampName: $('#delskillname').val()
        };

        $.ajax({
            type: "POST",
            url: "/api/AdminSkill/DeleteSkill",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Delete champions skill successful: " + response.statusMessage);
                    $('#deleteskillpModal').modal('hide');
                    $('#deleteskillForm')[0].reset();
                    location.reload();

                } else {
                    alert("Delete champions skill failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during delete skill.");
            }
        });
    }
    function Submit_Skill() {
        var formData = {
            ChampName: $('#champnameskill').val(),
            NoiTai: $('#skillnt').val(),
            SkillQ: $('#skillq').val(),
            SkillW: $('#skillw').val(),
            SkillE: $('#skille').val(),
            SkillR: $('#skillr').val(),
            AVA_NT: $('#avant').val(),
            AVA_Q: $('#avaq').val(),
            AVA_W: $('#avaw').val(),
            AVA_E: $('#avae').val(),
            AVA_R: $('#avar').val(),
            Vdnt: $('#vdnt').val(),
            Vdq: $('#vdq').val(),
            Vdw: $('#vdw').val(),
            Vde: $('#vde').val(),
            Vdr: $('#vdr').val()
        };

        // Log the form data to verify its correctness
        console.log("Form Data: ", formData);

        $.ajax({
            type: "POST",
            url: "/api/AdminSkill/AddSkills",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Add skills successful: " + response.statusMessage);
                    $('#addskillModal').modal('hide');
                    $('#addskillForm')[0].reset(); // Optionally reset the form
                    location.reload();

                } else {
                    alert("Add skills failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during add skills.");
            }
        });
    }
    $(document).ready(function () {
        $.ajax({
            type: "GET",
            url: "/api/AdminSkill/GetSkills",
            dataType: "json",
            success: function (data) {
                var tbody = $('#skillsTableBody');
                tbody.empty();
                data.forEach(function (skill, index) {
                    var row = '<tr>' +
                        '<th scope="row">' + (index + 1) + '</th>' +
                        '<td>' + skill.champName + '</td>' +
                        '<td>' + skill.noiTai + '</td>' +
                        '<td>' + skill.skillQ + '</td>' +
                        '<td>' + skill.skillW + '</td>' +
                        '<td>' + skill.skillE + '</td>' +
                        '<td>' + skill.skillR + '</td>' +
                        '<td style="padding-right: 0px; padding-left: 0px;"> <img style="height: 45px; margin-left: 3px;" src="/Pictures/Skills/Skills_NT/' + skill.avA_NT + '" /><img style="height: 45px; margin-left: 3px;" src="/Pictures/Skills/Skills_Q/' + skill.avA_Q + '" /><img style="height: 45px; margin-left: 3px;" src="/Pictures/Skills/Skills_W/' + skill.avA_W + '" /><img style="height: 45px; margin-left: 3px;" src="/Pictures/Skills/Skills_E/' + skill.avA_E + '" /><img style="height: 45px; margin-left: 3px;" src="/Pictures/Skills/Skills_R/' + skill.avA_R + '" /> </td>' +
                        '<td style="padding-right: 0px; padding-left: 0px;"> <video muted loop style="height: 45px; margin-left: 3px;" src="/Videos/Video_Skill/' + skill.vdnt + '" /><video muted loop style="height: 45px; margin-left: 3px;" src="/Videos/Video_Skill/' + skill.vdq + '" /><video muted loop style="height: 45px; margin-left: 3px;" src="/Videos/Video_Skill/' + skill.vdw + '" /><video muted loop style="height: 45px; margin-left: 3px;" src="/Videos/Video_Skill/' + skill.vde + '" /><video muted loop style="height: 45px; margin-left: 3px;" src="/Videos/Video_Skill/' + skill.vde + '" /> </td>' +
                        '</tr>';
                    tbody.append(row);
                });
            },
            error: function (error) {
                console.error("Error fetching data:", error);
            }
        });
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(150)
                    .height(200);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

</script>