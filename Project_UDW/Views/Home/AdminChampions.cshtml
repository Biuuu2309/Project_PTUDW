@{
    ViewData["Title"] = "Champions";
    Layout = "~/Views/Shared/Master.cshtml";
}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>@ViewData["Title"]</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/css/AdminChampions.css">
<!-- jQuery should be loaded here -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div id="addchampModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Champions Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addchampForm">
                    <div class="mb-3">
                        <label for="champname" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="champname" name="champname" required>
                    </div>
                    <div class="mb-3">
                        <label for="nickname" class="form-label">Nick Name</label>
                        <input type="text" class="form-control" id="nickname" name="nickname" required>
                    </div>
                    <div class="mb-3">
                        <label for="describle" class="form-label">Describle</label>
                        <input type="text" class="form-control" id="describle" name="describle" required>
                    </div>
                    <div class="mb-3">
                        <label for="role" class="form-label">Role</label>
                        <input type="text" class="form-control" id="role" name="role" required>
                    </div>
                    <div class="mb-3">
                        <label for="level" class="form-label">Level</label>
                        <input type="text" class="form-control" id="level" name="level" required>
                    </div>
                    <div class="mb-3">
                        <label for="imagedd" class="form-label">Image DD</label>
                        <input type='file' class="form-control" id="imagedd" name="imagedd" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="imageava" class="form-label">Image AVA</label>
                        <input type='file' class="form-control" id="imageava" name="imageava" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <button type="button" class="btn btn-primary" onclick="SubmitChamp()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="deletechampModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Champions Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="deletechampForm">
                    <div class="mb-3">
                        <label for="delchampname" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="delchampname" name="delchampname" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="SubmitDeleteChamp()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="updatechampModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Champions Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="updatechampForm">
                    <div class="mb-3">
                        <label for="upchampname" class="form-label">Champ Name</label>
                        <input type="text" class="form-control" id="upchampname" name="upchampname" required>
                    </div>
                    <div class="mb-3">
                        <label for="upnickname" class="form-label">Nick Name</label>
                        <input type="text" class="form-control" id="upnickname" name="upnickname" required>
                    </div>
                    <div class="mb-3">
                        <label for="updescrible" class="form-label">Describle</label>
                        <input type="text" class="form-control" id="updescrible" name="updescrible" required>
                    </div>
                    <div class="mb-3">
                        <label for="uprole" class="form-label">Role</label>
                        <input type="text" class="form-control" id="uprole" name="uprole" required>
                    </div>
                    <div class="mb-3">
                        <label for="uplevel" class="form-label">Level</label>
                        <input type="text" class="form-control" id="uplevel" name="uplevel" required>
                    </div>
                    <div class="mb-3">
                        <label for="upimagedd" class="form-label">Image DD</label>
                        <input type='file' class="form-control" id="upimagedd" name="upimagedd" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upimageava" class="form-label">Image AVA</label>
                        <input type='file' class="form-control" id="upimageava" name="upimageava" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <button type="button" class="btn btn-primary" onclick="SubmitUpdateChamp()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row add_champ_main">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-9"></div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Add_Champ()">
                            <a style="float: right; cursor: pointer">Add a champ</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Delete_Champ()">
                            <a style="float: right; cursor: pointer">Delete a champ</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Update_Champ()">
                            <a style="float: right; cursor: pointer">Update a champ</a>
                        </div>
                    </div>
                    <h4 class="card-title">Champions</h4>
                    <h6 class="card-title mt-5"><i class="me-1 font-18 mdi mdi-numeric-1-box-multiple-outline"></i>Details</h6>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">STT</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Other Name</th>
                                    <th scope="col">Describle</th>
                                    <th scope="col">Role</th>
                                    <th scope="col">Level</th>
                                    <th scope="col">ImageDD</th>
                                    <th scope="col">ImageAVA</th>
                                </tr>
                            </thead>
                            <tbody id="championsTableBody">
                                
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function Add_Champ() {
        var modal = new bootstrap.Modal(document.getElementById('addchampModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Delete_Champ() {
        var modal = new bootstrap.Modal(document.getElementById('deletechampModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Update_Champ() {
        var modal = new bootstrap.Modal(document.getElementById('updatechampModal'), {
            keyboard: false
        });
        modal.show();
    }
    function SubmitChamp() {
        var formData = {
            champname: $('#champname').val(),
            nickname: $('#nickname').val(),
            describle: $('#describle').val(),
            role: $('#role').val(),
            level: $('#level').val(),
            imagedd: $('#imagedd').val(),
            imageava: $('#imageava').val()
        };

        $.ajax({
            type: "POST",
            url: "/api/AdminChampions/AddChampions",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Add champions successful: " + response.statusMessage);
                    $('#addchampModal').modal('hide');
                    $('#addchampForm')[0].reset();
                    location.reload();

                } else {
                    alert("Add champions failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during add champ.");
            }
        });
    }
    function SubmitUpdateChamp() {
        var formData = {
            champname: $('#upchampname').val(),
            nickname: $('#upnickname').val(),
            describle: $('#updescrible').val(),
            role: $('#uprole').val(),
            level: $('#uplevel').val(),
            imagedd: $('#upimagedd').val(),
            imageava: $('#upimageava').val()
        };
        $.ajax({
            type: "POST",
            url: "/api/AdminChampions/UpdateChamp",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert('Champion updated successfully!');
                    $('#updatechampModal').modal('hide');
                    $('#updatechampForm')[0].reset();
                    location.reload();
                } else {
                    alert('Update failed: ' + response.statusMessage);
                }
            },
            error: function (error) {
                console.error('AJAX error:', error);
                alert('Error updating champion');
            }
        });
    }
    function SubmitDeleteChamp() {
        var formData = {
            champname: $('#delchampname').val()
        };

        $.ajax({
            type: "POST",
            url: "/api/AdminChampions/DeleteChamp",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Delete champions successful: " + response.statusMessage);
                    $('#deletechampModal').modal('hide');
                    $('#deletechampForm')[0].reset();
                    location.reload();

                } else {
                    alert("Delete champions failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during delete champ.");
            }
        });
    }
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: "/api/AdminChampions/GetChampions",
            dataType: "json",
            success: function (data) {
                var tbody = $('#championsTableBody');
                tbody.empty();
                data.forEach(function (champion, index) {
                    var row = '<tr>' +
                        '<th scope="row">' + (index + 1) + '</th>' +
                        '<td>' + champion.champName + '</td>' +
                        '<td>' + champion.nickName + '</td>' +
                        '<td>' + champion.describle + '</td>' +
                        '<td>' + champion.role + '</td>' +
                        '<td>' + champion.level + '</td>' +
                        '<td> <img style="height: 100px;" src="/Pictures/Backgrounds_Champs/' + champion.imageDD + '" /> </td>' +
                        '<td> <img style="height: 100px;" src="/Pictures/Champions/' + champion.imageAVA + '" /> </td>' +
                        '</tr>';
                    tbody.append(row);
                });
            },
            error: function (error) {
                console.error("Error fetching data:", error);
            }
        });
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(150)
                    .height(200);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>