@{
    ViewData["Title"] = "News";
    Layout = "~/Views/Shared/Master.cshtml";
}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>@ViewData["Title"]</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="~/css/AdminNews.css">
<!-- jQuery should be loaded here -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div id="addnewsModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add News Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addnewsForm">
                    <div class="mb-3">
                        <label for="addnamenews" class="form-label">Name News</label>
                        <input type="text" class="form-control" id="addnamenews" name="addnamenews" required>
                    </div>
                    <div class="mb-3">
                        <label for="addpicnewmain" class="form-label">Image Main</label>
                        <input type='file' class="form-control" id="addpicnewmain" name="addpicnewmain" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="addpicnewblur" class="form-label">Image Blur</label>
                        <input type='file' class="form-control" id="addpicnewblur" name="addpicnewblur" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="addmaintitle" class="form-label">Main Title</label>
                        <input type="text" class="form-control" id="addmaintitle" name="addmaintitle" required>
                    </div>
                    <div class="mb-3">
                        <label for="adddestitle" class="form-label">Des Title</label>
                        <input type="text" class="form-control" id="adddestitle" name="adddestitle" required>
                    </div>
                    <div class="mb-3">
                        <label for="addmota" class="form-label">Mo ta</label>
                        <input type="text" class="form-control" id="addmota" name="addmota" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle1" class="form-label">Title 1</label>
                        <input type="text" class="form-control" id="addtitle1" name="addtitle1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle1_con1" class="form-label">Title 1.1</label>
                        <input type="text" class="form-control" id="addtitle1_con1" name="addtitle1_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle1_con2" class="form-label">Title 1.2</label>
                        <input type="text" class="form-control" id="addtitle1_con2" name="addtitle1_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle2" class="form-label">Title 2</label>
                        <input type="text" class="form-control" id="addtitle2" name="addtitle2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle2_con1" class="form-label">Title 2.1</label>
                        <input type="text" class="form-control" id="addtitle2_con1" name="addtitle2_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle2_con2" class="form-label">Title 2.2</label>
                        <input type="text" class="form-control" id="addtitle2_con2" name="addtitle2_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle3" class="form-label">Title 3</label>
                        <input type="text" class="form-control" id="addtitle3" name="addtitle3" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle3_con1" class="form-label">Title 3.1</label>
                        <input type="text" class="form-control" id="addtitle3_con1" name="addtitle3_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle3_con2" class="form-label">Title 3.2</label>
                        <input type="text" class="form-control" id="addtitle3_con2" name="addtitle3_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle4" class="form-label">Title 4</label>
                        <input type="text" class="form-control" id="addtitle4" name="addtitle4" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle4_con1" class="form-label">Title 4.1</label>
                        <input type="text" class="form-control" id="addtitle4_con1" name="addtitle4_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle4_con2" class="form-label">Title 4.2</label>
                        <input type="text" class="form-control" id="addtitle4_con2" name="addtitle4_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle5" class="form-label">Title 5</label>
                        <input type="text" class="form-control" id="addtitle5" name="addtitle5" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle5_con1" class="form-label">Title 5.1</label>
                        <input type="text" class="form-control" id="addtitle5_con1" name="addtitle5_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtitle5_con2" class="form-label">Title 5.2</label>
                        <input type="text" class="form-control" id="addtitle5_con2" name="addtitle5_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="addtomtat" class="form-label">Tom tat</label>
                        <input type="text" class="form-control" id="addtomtat" name="addtomtat" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="Submit_Add_News()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="deletenewsModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete News Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="deletenewsForm">
                    <div class="mb-3">
                        <label for="delnamenews" class="form-label">Name News</label>
                        <input type="text" class="form-control" id="delnamenews" name="delnamenews" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="Submit_Delete_News()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div id="updatenewsModal" class="modal fade" tabindex="-1" aria-labelledby="ShowModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update News Form</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="updatenewsForm">
                    <div class="mb-3">
                        <label for="upnamenews" class="form-label">Name News</label>
                        <input type="text" class="form-control" id="upnamenews" name="upnamenews" required>
                    </div>
                    <div class="mb-3">
                        <label for="uppicnewmain" class="form-label">Image Main</label>
                        <input type='file' class="form-control" id="uppicnewmain" name="uppicnewmain" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="uppicnewblur" class="form-label">Image Blur</label>
                        <input type='file' class="form-control" id="uppicnewblur" name="uppicnewblur" required onchange="readURL(this);" />
                        <img id="blah" src="#" alt="" />
                    </div>
                    <div class="mb-3">
                        <label for="upmaintitle" class="form-label">Main title</label>
                        <input type="text" class="form-control" id="upmaintitle" name="upmaintitle" required>
                    </div>
                    <div class="mb-3">
                        <label for="updestitle" class="form-label">Des title</label>
                        <input type="text" class="form-control" id="updestitle" name="updestitle" required>
                    </div>
                    <div class="mb-3">
                        <label for="upmota" class="form-label">Mo ta</label>
                        <input type="text" class="form-control" id="upmota" name="upmota" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle1" class="form-label">Title 1</label>
                        <input type="text" class="form-control" id="uptitle1" name="uptitle1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle1_con1" class="form-label">Title 1.1</label>
                        <input type="text" class="form-control" id="uptitle1_con1" name="uptitle1_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle1_con2" class="form-label">Title 1.2</label>
                        <input type="text" class="form-control" id="uptitle1_con2" name="uptitle1_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle2" class="form-label">Title 2</label>
                        <input type="text" class="form-control" id="uptitle2" name="uptitle2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle2_con1" class="form-label">Title 2.1</label>
                        <input type="text" class="form-control" id="uptitle2_con1" name="uptitle2_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle2_con2" class="form-label">Title 2.2</label>
                        <input type="text" class="form-control" id="uptitle2_con2" name="uptitle2_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle3" class="form-label">Title 3</label>
                        <input type="text" class="form-control" id="uptitle3" name="uptitle3" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle3_con1" class="form-label">Title 3.1</label>
                        <input type="text" class="form-control" id="uptitle3_con1" name="uptitle3_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle3_con2" class="form-label">Title 3.2</label>
                        <input type="text" class="form-control" id="uptitle3_con2" name="uptitle3_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle4" class="form-label">Title 4</label>
                        <input type="text" class="form-control" id="uptitle4" name="uptitle4" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle4_con1" class="form-label">Title 4.1</label>
                        <input type="text" class="form-control" id="uptitle4_con1" name="uptitle4_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle4_con2" class="form-label">Title 4.2</label>
                        <input type="text" class="form-control" id="uptitle4_con2" name="uptitle4_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle5" class="form-label">Title 5</label>
                        <input type="text" class="form-control" id="uptitle5" name="uptitle5" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle5_con1" class="form-label">Title 5.1</label>
                        <input type="text" class="form-control" id="uptitle5_con1" name="uptitle5_con1" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptitle5_con2" class="form-label">Title 5.2</label>
                        <input type="text" class="form-control" id="uptitle5_con2" name="uptitle5_con2" required>
                    </div>
                    <div class="mb-3">
                        <label for="uptomtat" class="form-label">Tom tat</label>
                        <input type="text" class="form-control" id="uptomtat" name="uptomtat" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="Submit_Update_News()">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row add_news_main">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-9"></div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Add_News()">
                            <a style="float: right; cursor: pointer">Add a news</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Delete_News()">
                            <a style="float: right; cursor: pointer">Delete a news</a>
                        </div>
                        <div class="col-md-1 col-md-offset-4 alert alert-info add_btn" onclick="Update_News()">
                            <a style="float: right; cursor: pointer">Update a news</a>
                        </div>
                    </div>
                    <h4 class="card-title">News</h4>
                    <h6 class="card-title mt-5"><i class="me-1 font-18 mdi mdi-numeric-1-box-multiple-outline"></i>Details</h6>
                    <div class="table-responsive" id="newsTableBody"></div>
                </div>

            </div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function Add_News() {
        var modal = new bootstrap.Modal(document.getElementById('addnewsModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Delete_News() {
        var modal = new bootstrap.Modal(document.getElementById('deletenewsModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Update_News() {
        var modal = new bootstrap.Modal(document.getElementById('updatenewsModal'), {
            keyboard: false
        });
        modal.show();
    }
    function Submit_Add_News() {
        var formData = {
            namenews: $('#addnamenews').val(),
            picnewmain: $('#addpicnewmain').val(),
            picnewblur: $('#addpicnewblur').val(),
            maintitle: $('#addmaintitle').val(),
            destitle: $('#adddestitle').val(),
            mota: $('#addmota').val(),
            title1: $('#addtitle1').val(),
            title1_con1: $('#addtitle1_con1').val(),
            title1_con2: $('#addtitle1_con2').val(),
            title2: $('#addtitle2').val(),
            title2_con1: $('#addtitle2_con1').val(),
            title2_con2: $('#addtitle2_con2').val(),
            title3: $('#addtitle3').val(),
            title3_con1: $('#addtitle3_con1').val(),
            title3_con2: $('#addtitle3_con2').val(),
            title4: $('#addtitle4').val(),
            title4_con1: $('#addtitle4_con1').val(),
            title4_con2: $('#addtitle4_con2').val(),
            title5: $('#addtitle5').val(),
            title5_con1: $('#addtitle5_con1').val(),
            title5_con2: $('#addtitle5_con2').val(),
            tomtat: $('#addtomtat').val()
        };

        $.ajax({
            type: "POST",
            url: "/api/AdminNews/AddNews",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Add news successful: " + response.statusMessage);
                    $('#addnewsModal').modal('hide');
                    $('#addnewsForm')[0].reset();
                    location.reload();

                } else {
                    alert("Add news failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during add news.");
            }
        });
    }
    function Submit_Update_News() {
        var formData = {
            namenews: $('#upnamenews').val(),
            picnewmain: $('#uppicnewmain').val(),
            picnewblur: $('#uppicnewblur').val(),
            maintitle: $('#upmaintitle').val(),
            destitle: $('#updestitle').val(),
            mota: $('#upmota').val(),
            title1: $('#uptitle1').val(),
            title1_con1: $('#uptitle1_con1').val(),
            title1_con2: $('#uptitle1_con2').val(),
            title2: $('#uptitle2').val(),
            title2_con1: $('#uptitle2_con1').val(),
            title2_con2: $('#uptitle2_con2').val(),
            title3: $('#uptitle3').val(),
            title3_con1: $('#uptitle3_con1').val(),
            title3_con2: $('#uptitle3_con2').val(),
            title4: $('#uptitle4').val(),
            title4_con1: $('#uptitle4_con1').val(),
            title4_con2: $('#uptitle4_con2').val(),
            title5: $('#uptitle5').val(),
            title5_con1: $('#uptitle5_con1').val(),
            title5_con2: $('#uptitle5_con2').val(),
            tomtat: $('#uptomtat').val()
        };
        $.ajax({
            type: "POST",
            url: "/api/AdminNews/UpdateNews",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert('News updated successfully!');
                    $('#updatenewsModal').modal('hide');
                    $('#updatenewsForm')[0].reset();
                    location.reload();
                } else {
                    alert('Update failed: ' + response.statusMessage);
                }
            },
            error: function (error) {
                console.error('AJAX error:', error);
                alert('Error updating news');
            }
        });
    }
    function Submit_Delete_News() {
        var formData = {
            namenews: $('#delnamenews').val()
        };

        $.ajax({
            type: "POST",
            url: "/api/AdminNews/DeleteNews",
            data: JSON.stringify(formData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.statusCode === 200) {
                    alert("Delete news successful: " + response.statusMessage);
                    $('#deletenewsModal').modal('hide');
                    $('#deletenewsForm')[0].reset();
                    location.reload();

                } else {
                    alert("Delete news failed: " + response.statusMessage);
                }
            },
            error: function (error) {
                console.error("AJAX error response:", error);
                alert("Error during delete news.");
            }
        });
    }
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: "/api/AdminNews/GetNews",
            dataType: "json",
            success: function (data) {
                var tbody = $('#newsTableBody');
                tbody.empty();
                data.forEach(function (news, index) {
                    var row = 
                        '<button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" style="margin-right: 10px;" data-bs-target="#offcanvasTop' + index + '" aria-controls="offcanvasTop' + index + '"> Name news: ' + news.namenews + ' </button>' +
                        '<div class="offcanvas offcanvas-top" style="height: 700px;" tabindex="-1" id="offcanvasTop' + index + '" aria-labelledby="offcanvasTopLabel' + index + '">' +
                        '<div class="offcanvas-header">' +
                        '<h5 id="offcanvasTopLabel' + index + '"><h3>Details News</h3></h5>' +
                        '<button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="offcanvas-body">' +
                        '<div class="row">' +
                        '<div class="col-xxl-6">' +
                        '<h4>Image main</h4>' +
                        '<img style="height: 100px;" src="/Pictures/News/' + news.picnewmain + '" />' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Image blur</h4>' +
                        '<img style="height: 100px;" src="/Pictures/News/' + news.picnewblur + '" />' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-4">' +
                        '<h4>Main Title: ' + news.maintitle + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-8">' +
                        '<h4>Main Title Con: </h4>' +
                        '<p>' + news.destitle + ' </p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Mo ta:</h4>' +
                        '<p>' + news.mota + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Title 1: ' + news.title1 + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 1</h4>' +
                        '<p>' + news.title1_con1 + '</p>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 2</h4>' +
                        '<p>' + news.title1_con2 + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Title 2: ' + news.title2 + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 1</h4>' +
                        '<p>' + news.title2_con1 + '</p>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 2</h4>' +
                        '<p>' + news.title2_con2 + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Title 3: ' + news.title3 + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 1</h4>' +
                        '<p>' + news.title3_con1 + '</p>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 2</h4>' +
                        '<p>' + news.title3_con2 + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Title 4: ' + news.title4 + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 1</h4>' +
                        '<p>' + news.title4_con1 + '</p>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 2</h4>' +
                        '<p>' + news.title4_con2 + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Title 5: ' + news.title5 + '</h4>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 1</h4>' +
                        '<p>' + news.title5_con1 + '</p>' +
                        '</div>' +
                        '<div class="col-xxl-6">' +
                        '<h4>Details Title 2</h4>' +
                        '<p>' + news.title5_con2 + '</p>' +
                        '</div>' +
                        '<hr/>' +
                        '<div class="col-xxl-12">' +
                        '<h4>Tom tat: </h4>' +
                        '<p>' + news.tomtat + ' </p>'
                        '</div>' +
                        '<hr/>' +
                        '</div>' +
                        '</div>' +
                        '</div>';
                    tbody.append(row);
                });
            },
            error: function (error) {
                console.error("Error fetching data:", error);
            }
        });
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(150)
                    .height(200);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>